3.2 Server Setup (Node + Express + TypeScript)

mkdir -p server && cd server
npm init -y

# Runtime dependencies
npm i express cors body-parser pg slugify dotenv

# Dev dependencies
npm i -D typescript ts-node-dev @types/node @types/express \
       @types/cors @types/body-parser @types/pg @types/slugify \
       jest ts-jest @types/jest supertest @types/supertest

# Generate tsconfig
npx tsc --init --rootDir src --outDir dist --esModuleInterop --resolveJsonModule \
        --lib es2020,dom --module commonjs --target es2020 --strict true \
        --skipLibCheck true --forceConsistentCasingInFileNames true

tsconfig.json (minimal):

{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "**/*.test.ts", "src/__tests__", "src/parser/__tests__"]
}

# Directory scaffold
mkdir -p src/__tests__ src/api src/config src/db src/models \
         src/parser src/repositories src/routes src/services src/utils

Create .env.example and .env (remember .env is git‑ignored):

echo "PORT=3001\nDB_HOST=localhost\nDB_PORT=5432\nDB_USER=career_user\nDB_PASSWORD=career_password\nDB_NAME=career_explorer\nNODE_ENV=development" > .env.example
cp .env.example .env

src/server.ts:

import express from 'express';
import cors from 'cors';
import bodyParser from 'body-parser';
import dotenv from 'dotenv';

dotenv.config();

const app = express();
const PORT = process.env.PORT || 3001;

app.use(cors());
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));

app.get('/api/health', (_req, res) => {
  res.json({ status: 'ok', message: 'Server is healthy and running!' });
});

app.listen(PORT, () => {
  console.log(`Server listening on http://localhost:${PORT}`);
});

export default app;

Add scripts to server/package.json:

"scripts": {
  "start": "node dist/server.js",
  "dev": "ts-node-dev --respawn --transpile-only src/server.ts",
  "build": "tsc",
  "test": "jest --coverage"
}

jest.config.js:

module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  testMatch: ['**/__tests__/**/*.test.ts?(x)'],
  collectCoverage: true,
  coverageDirectory: 'coverage',
  collectCoverageFrom: [
    'src/**/*.ts',
    '!src/**/*.d.ts',
    '!src/server.ts',
    '!src/db/index.ts',
    '!src/db/seed.ts',
    '!src/parser/cli.ts',
    '!src/parser/watch.ts'
  ],
  setupFiles: ['dotenv/config']
};

src/__tests__/server.test.ts:

import request from 'supertest';
import app from '../server';

describe('GET /api/health', () => {
  it('returns 200 OK', async () => {
    const res = await request(app).get('/api/health');
    expect(res.status).toBe(200);
    expect(res.body).toEqual({ status: 'ok', message: 'Server is healthy and running!' });
  });
});